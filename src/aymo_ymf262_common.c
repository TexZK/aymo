/*
AYMO - Accelerated YaMaha Operator
Copyright (c) 2023-2024 Andrea Zoppi.

This file is part of AYMO.

AYMO is free software: you can redistribute it and/or modify it under the
terms of the GNU Lesser General Public License as published by the Free
Software Foundation, either version 2.1 of the License, or (at your option)
any later version.

AYMO is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for
more details.

You should have received a copy of the GNU Lesser General Public License
along with AYMO. If not, see <https://www.gnu.org/licenses/>.
*/

#include "aymo_ymf262_common.h"

AYMO_CXX_EXTERN_C_BEGIN


// Exponential look-up table
// Values are pre-multiplied by 2
const int16_t AYMO_ALIGN(4) aymo_ymf262_exp_x2_table[256 + 4] =
{
    0x0FF4, 0x0FEA, 0x0FDE, 0x0FD4, 0x0FC8, 0x0FBE, 0x0FB4, 0x0FA8,
    0x0F9E, 0x0F92, 0x0F88, 0x0F7E, 0x0F72, 0x0F68, 0x0F5C, 0x0F52,
    0x0F48, 0x0F3E, 0x0F32, 0x0F28, 0x0F1E, 0x0F14, 0x0F08, 0x0EFE,
    0x0EF4, 0x0EEA, 0x0EE0, 0x0ED4, 0x0ECA, 0x0EC0, 0x0EB6, 0x0EAC,
    0x0EA2, 0x0E98, 0x0E8E, 0x0E84, 0x0E7A, 0x0E70, 0x0E66, 0x0E5C,
    0x0E52, 0x0E48, 0x0E3E, 0x0E34, 0x0E2A, 0x0E20, 0x0E16, 0x0E0C,
    0x0E04, 0x0DFA, 0x0DF0, 0x0DE6, 0x0DDC, 0x0DD2, 0x0DCA, 0x0DC0,
    0x0DB6, 0x0DAC, 0x0DA4, 0x0D9A, 0x0D90, 0x0D88, 0x0D7E, 0x0D74,
    0x0D6A, 0x0D62, 0x0D58, 0x0D50, 0x0D46, 0x0D3C, 0x0D34, 0x0D2A,
    0x0D22, 0x0D18, 0x0D10, 0x0D06, 0x0CFE, 0x0CF4, 0x0CEC, 0x0CE2,
    0x0CDA, 0x0CD0, 0x0CC8, 0x0CBE, 0x0CB6, 0x0CAE, 0x0CA4, 0x0C9C,
    0x0C92, 0x0C8A, 0x0C82, 0x0C78, 0x0C70, 0x0C68, 0x0C60, 0x0C56,
    0x0C4E, 0x0C46, 0x0C3C, 0x0C34, 0x0C2C, 0x0C24, 0x0C1C, 0x0C12,
    0x0C0A, 0x0C02, 0x0BFA, 0x0BF2, 0x0BEA, 0x0BE0, 0x0BD8, 0x0BD0,
    0x0BC8, 0x0BC0, 0x0BB8, 0x0BB0, 0x0BA8, 0x0BA0, 0x0B98, 0x0B90,
    0x0B88, 0x0B80, 0x0B78, 0x0B70, 0x0B68, 0x0B60, 0x0B58, 0x0B50,
    0x0B48, 0x0B40, 0x0B38, 0x0B32, 0x0B2A, 0x0B22, 0x0B1A, 0x0B12,
    0x0B0A, 0x0B02, 0x0AFC, 0x0AF4, 0x0AEC, 0x0AE4, 0x0ADE, 0x0AD6,
    0x0ACE, 0x0AC6, 0x0AC0, 0x0AB8, 0x0AB0, 0x0AA8, 0x0AA2, 0x0A9A,
    0x0A92, 0x0A8C, 0x0A84, 0x0A7C, 0x0A76, 0x0A6E, 0x0A68, 0x0A60,
    0x0A58, 0x0A52, 0x0A4A, 0x0A44, 0x0A3C, 0x0A36, 0x0A2E, 0x0A28,
    0x0A20, 0x0A18, 0x0A12, 0x0A0C, 0x0A04, 0x09FE, 0x09F6, 0x09F0,
    0x09E8, 0x09E2, 0x09DA, 0x09D4, 0x09CE, 0x09C6, 0x09C0, 0x09B8,
    0x09B2, 0x09AC, 0x09A4, 0x099E, 0x0998, 0x0990, 0x098A, 0x0984,
    0x097C, 0x0976, 0x0970, 0x096A, 0x0962, 0x095C, 0x0956, 0x0950,
    0x0948, 0x0942, 0x093C, 0x0936, 0x0930, 0x0928, 0x0922, 0x091C,
    0x0916, 0x0910, 0x090A, 0x0904, 0x08FC, 0x08F6, 0x08F0, 0x08EA,
    0x08E4, 0x08DE, 0x08D8, 0x08D2, 0x08CC, 0x08C6, 0x08C0, 0x08BA,
    0x08B4, 0x08AE, 0x08A8, 0x08A2, 0x089C, 0x0896, 0x0890, 0x088A,
    0x0884, 0x087E, 0x0878, 0x0872, 0x086C, 0x0866, 0x0860, 0x085A,
    0x0854, 0x0850, 0x084A, 0x0844, 0x083E, 0x0838, 0x0832, 0x082C,
    0x0828, 0x0822, 0x081C, 0x0816, 0x0810, 0x080C, 0x0806, 0x0800,
    0x0800, 0x0800, 0x0800, 0x0800
};


// Logsin look-up table
const int16_t AYMO_ALIGN(4) aymo_ymf262_logsin_table[256 + 4] =
{
    0x0859, 0x06C3, 0x0607, 0x058B, 0x052E, 0x04E4, 0x04A6, 0x0471,
    0x0443, 0x041A, 0x03F5, 0x03D3, 0x03B5, 0x0398, 0x037E, 0x0365,
    0x034E, 0x0339, 0x0324, 0x0311, 0x02FF, 0x02ED, 0x02DC, 0x02CD,
    0x02BD, 0x02AF, 0x02A0, 0x0293, 0x0286, 0x0279, 0x026D, 0x0261,
    0x0256, 0x024B, 0x0240, 0x0236, 0x022C, 0x0222, 0x0218, 0x020F,
    0x0206, 0x01FD, 0x01F5, 0x01EC, 0x01E4, 0x01DC, 0x01D4, 0x01CD,
    0x01C5, 0x01BE, 0x01B7, 0x01B0, 0x01A9, 0x01A2, 0x019B, 0x0195,
    0x018F, 0x0188, 0x0182, 0x017C, 0x0177, 0x0171, 0x016B, 0x0166,
    0x0160, 0x015B, 0x0155, 0x0150, 0x014B, 0x0146, 0x0141, 0x013C,
    0x0137, 0x0133, 0x012E, 0x0129, 0x0125, 0x0121, 0x011C, 0x0118,
    0x0114, 0x010F, 0x010B, 0x0107, 0x0103, 0x00FF, 0x00FB, 0x00F8,
    0x00F4, 0x00F0, 0x00EC, 0x00E9, 0x00E5, 0x00E2, 0x00DE, 0x00DB,
    0x00D7, 0x00D4, 0x00D1, 0x00CD, 0x00CA, 0x00C7, 0x00C4, 0x00C1,
    0x00BE, 0x00BB, 0x00B8, 0x00B5, 0x00B2, 0x00AF, 0x00AC, 0x00A9,
    0x00A7, 0x00A4, 0x00A1, 0x009F, 0x009C, 0x0099, 0x0097, 0x0094,
    0x0092, 0x008F, 0x008D, 0x008A, 0x0088, 0x0086, 0x0083, 0x0081,
    0x007F, 0x007D, 0x007A, 0x0078, 0x0076, 0x0074, 0x0072, 0x0070,
    0x006E, 0x006C, 0x006A, 0x0068, 0x0066, 0x0064, 0x0062, 0x0060,
    0x005E, 0x005C, 0x005B, 0x0059, 0x0057, 0x0055, 0x0053, 0x0052,
    0x0050, 0x004E, 0x004D, 0x004B, 0x004A, 0x0048, 0x0046, 0x0045,
    0x0043, 0x0042, 0x0040, 0x003F, 0x003E, 0x003C, 0x003B, 0x0039,
    0x0038, 0x0037, 0x0035, 0x0034, 0x0033, 0x0031, 0x0030, 0x002F,
    0x002E, 0x002D, 0x002B, 0x002A, 0x0029, 0x0028, 0x0027, 0x0026,
    0x0025, 0x0024, 0x0023, 0x0022, 0x0021, 0x0020, 0x001F, 0x001E,
    0x001D, 0x001C, 0x001B, 0x001A, 0x0019, 0x0018, 0x0017, 0x0017,
    0x0016, 0x0015, 0x0014, 0x0014, 0x0013, 0x0012, 0x0011, 0x0011,
    0x0010, 0x000F, 0x000F, 0x000E, 0x000D, 0x000D, 0x000C, 0x000C,
    0x000B, 0x000A, 0x000A, 0x0009, 0x0009, 0x0008, 0x0008, 0x0007,
    0x0007, 0x0007, 0x0006, 0x0006, 0x0005, 0x0005, 0x0005, 0x0004,
    0x0004, 0x0004, 0x0003, 0x0003, 0x0003, 0x0002, 0x0002, 0x0002,
    0x0002, 0x0001, 0x0001, 0x0001, 0x0001, 0x0001, 0x0001, 0x0001,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000
};


// Word index to Slot index
const int8_t aymo_ymf262_word_to_slot[AYMO_YMF262_SLOT_NUM_MAX] =
{
     0,  1,  2, 48, 18, 19, 20, 52,
    12, 13, 14, 56, 30, 31, 32, 60,
     3,  4,  5, 49, 21, 22, 23, 53,
    15, 16, 17, 57, 33, 34, 35, 61,
     6,  7,  8, 50, 24, 25, 26, 54,
    42, 43, 44, 58, 36, 37, 38, 62,
     9, 10, 11, 51, 27, 28, 29, 55,
    45, 46, 47, 59, 39, 40, 41, 63
};

// Slot index to Word index
const int8_t aymo_ymf262_slot_to_word[AYMO_YMF262_SLOT_NUM_MAX] =
{
     0,  1,  2, 16, 17, 18, 32, 33,
    34, 48, 49, 50,  8,  9, 10, 24,
    25, 26,  4,  5,  6, 20, 21, 22,
    36, 37, 38, 52, 53, 54, 12, 13,
    14, 28, 29, 30, 44, 45, 46, 60,
    61, 62, 40, 41, 42, 56, 57, 58,
     3, 19, 35, 51,  7, 23, 39, 55,
    11, 27, 43, 59, 15, 31, 47, 63
};


// Word index to Channel_2xOP index
const int8_t aymo_ymf262_word_to_ch2x[AYMO_YMF262_SLOT_NUM_MAX] =
{
     0,  1,  2, 24,  9, 10, 11, 26,
     6,  7,  8, 28, 15, 16, 17, 30,
     0,  1,  2, 24,  9, 10, 11, 26,
     6,  7,  8, 28, 15, 16, 17, 30,
     3,  4,  5, 25, 12, 13, 14, 27,
    21, 22, 23, 29, 18, 19, 20, 31,
     3,  4,  5, 25, 12, 13, 14, 27,
    21, 22, 23, 29, 18, 19, 20, 31
};

// Channel_2xOP index to Word index
const int8_t aymo_ymf262_ch2x_to_word[AYMO_YMF262_SLOT_NUM_MAX / 2][2/* slot */] =
{
    {  0, 16 },  {  1, 17 },  {  2, 18 },  { 32, 48 },
    { 33, 49 },  { 34, 50 },  {  8, 24 },  {  9, 25 },
    { 10, 26 },  {  4, 20 },  {  5, 21 },  {  6, 22 },
    { 36, 52 },  { 37, 53 },  { 38, 54 },  { 12, 28 },
    { 13, 29 },  { 14, 30 },  { 44, 60 },  { 45, 61 },
    { 46, 62 },  { 40, 56 },  { 41, 57 },  { 42, 58 },
    {  3, 19 },  { 35, 51 },  {  7, 23 },  { 39, 55 },
    { 11, 27 },  { 43, 59 },  { 15, 31 },  { 47, 63 }
};


// Word index to Channel_4xOP index
const int8_t aymo_ymf262_word_to_ch4x[AYMO_YMF262_SLOT_NUM_MAX] =
{
     0,  1,  2, 12,  3,  4,  5, 13,
     6,  7,  8, 14,  9, 10, 11, 15,
     0,  1,  2, 12,  3,  4,  5, 13,
     6,  7,  8, 14,  9, 10, 11, 15,
     0,  1,  2, 12,  3,  4,  5, 13,
     6,  7,  8, 14,  9, 10, 11, 15,
     0,  1,  2, 12,  3,  4,  5, 13,
     6,  7,  8, 14,  9, 10, 11, 15
};

// Channel_4xOP index to Word index
const int8_t aymo_ymf262_ch4x_to_word[AYMO_YMF262_SLOT_NUM_MAX / 4][4/* slot */] =
{
    {  0, 16, 32, 48 },  {  1, 17, 33, 49 },
    {  2, 18, 34, 50 },  {  4, 20, 36, 52 },
    {  5, 21, 37, 53 },  {  6, 22, 38, 54 },
    {  8, 24, 40, 56 },  {  9, 25, 41, 57 },
    { 10, 26, 42, 58 },  { 12, 28, 44, 60 },
    { 13, 29, 45, 61 },  { 14, 30, 46, 62 },
    {  3, 19, 35, 51 },  {  7, 23, 39, 55 },
    { 11, 27, 43, 59 },  { 15, 31, 47, 63 }
};

// Channel_4xOP index to Channel_2xOP index pairs
const int8_t aymo_ymf262_ch4x_to_pair[AYMO_YMF262_CHANNEL_NUM_MAX / 2][2/* slot */] =
{
    {  0,  3 },  {  1,  4 },  {  2,  5 },
    {  9, 12 },  { 10, 13 },  { 11, 14 },
    {  6, 21 },  {  7, 22 },  {  8, 23 },
    { 15, 18 },  { 16, 19 },  { 17, 20 },
    { 24, 25 },  { 26, 27 },  { 28, 29 },  { 30, 31 }
};

// Paired Channel_2xOP index
const int8_t aymo_ymf262_ch2x_paired[AYMO_YMF262_CHANNEL_NUM_MAX] =
{
     3,  4,  5,
     0,  1,  2,
    21, 22, 23,
    12, 13, 14,
     9, 10, 11,
    18, 19, 20,
    15, 16, 17,
     6,  7,  8,
    25, 24, 27, 26,
    29, 28, 31, 30
};


// Sub-address to Slot index
const int8_t aymo_ymf262_subaddr_to_slot[AYMO_YMF262_SLOT_NUM_MAX] =
{
     0,  1,  2,  3,  4,  5, 48, 49,
     6,  7,  8,  9, 10, 11, 50, 51,
    12, 13, 14, 15, 16, 17, 52, 53,
    36, 37, 38, 39, 40, 41, 54, 55,

    18, 19, 20, 21, 22, 23, 56, 57,
    24, 25, 26, 27, 28, 29, 58, 59,
    30, 31, 32, 33, 34, 35, 60, 61,
    42, 43, 44, 45, 46, 47, 62, 63
};

// Slot index to sub-address
const int8_t aymo_ymf262_slot_to_subaddr[AYMO_YMF262_SLOT_NUM_MAX] =
{
     0,  1,  2,  3,  4,  5,  8,  9,
    10, 11, 12, 13, 16, 17, 18, 19,
    20, 21, 32, 33, 34, 35, 36, 37,
    40, 41, 42, 43, 44, 45, 48, 49,

    50, 51, 52, 53, 24, 25, 26, 27,
    28, 29, 56, 57, 58, 59, 60, 61,
     6,  7, 14, 15, 22, 23, 30, 31,
    38, 39, 46, 47, 54, 55, 62, 63
};


// Sub-address to Channel_2xOP index
const int8_t aymo_ymf262_subaddr_to_ch2x[AYMO_YMF262_CHANNEL_NUM_MAX] =
{
     0,  1,  2,  3,  4,  5,  6,  7,  8,
    18, 19, 20, 21, 22, 23, 24,

     9, 10, 11, 12, 13, 14, 15, 16, 17,
    25, 26, 27, 28, 29, 30, 31
};

// Channel_2xOP index to sub-address
const int8_t aymo_ymf262_ch2x_to_subaddr[AYMO_YMF262_CHANNEL_NUM_MAX] =
{
     0,  1,  2,  3,  4,  5,  6,  7,  8,
    16, 17, 18, 19, 20, 21, 22,

    23, 24,  9, 10, 11, 12, 13, 14, 15,
    25, 26, 27, 28, 29, 30, 31
};


const int8_t aymo_ymf262_pg_mult_x2_table[16] =
{
    1, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 20, 24, 24, 30, 30
};


const int8_t aymo_ymf262_eg_ksl_table[16] =
{
    0, 32, 40, 45, 48, 51, 53, 55, 56, 58, 59, 60, 61, 62, 63, 64
};

const int8_t aymo_ymf262_eg_kslsh_table[4] =
{
    8, 1, 2, 0
};


AYMO_CXX_EXTERN_C_END
