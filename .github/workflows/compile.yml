name: Compile

on:
  push:
    branches:
      - main

  pull_request:
    branches:
      - main

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:

    - name: checkout
      uses: actions/checkout@v4
      with:
        submodules: recursive

    - name: setup-python
      uses: actions/setup-python@v5

    - name: build
      uses: BSFishy/meson-build@v1.0.3
      with:
        action: build
        directory: builddir_debug
        setup-options: -Dbuildtype=debug
        meson-version: 1.4.0
        ninja-version: 1.11.1

  debugoptimized:
    runs-on: ubuntu-latest
    steps:

    - name: checkout
      uses: actions/checkout@v4
      with:
        submodules: recursive

    - name: setup-python
      uses: actions/setup-python@v5

    - name: build
      uses: BSFishy/meson-build@v1.0.3
      with:
        action: build
        directory: builddir_debugoptimized
        setup-options: -Dbuildtype=debugoptimized
        meson-version: 1.4.0
        ninja-version: 1.11.1

  release:
    runs-on: ubuntu-latest
    steps:

    - name: checkout
      uses: actions/checkout@v4
      with:
        submodules: recursive

    - name: setup-python
      uses: actions/setup-python@v5

    - name: build
      uses: BSFishy/meson-build@v1.0.3
      with:
        action: build
        directory: builddir_release
        setup-options: -Dbuildtype=release
        meson-version: 1.4.0
        ninja-version: 1.11.1
